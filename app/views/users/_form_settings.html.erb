<%= twitter_bootstrap_form_for @user, url: update_user_settings_path(@user), layout: :horizontal, default_div_class: 'col-lg-6' do |f| %>
  <%= render 'shared/error_messages', model: @user %>
  <%= f.collection_select :layer_id, [], Layer.all, :id, :name, {}, {} %>
  <div class="row">
    <span class="col-lg-offset-2 col-lg-6"><div id="map" style="width: 100%; height: 200px;"></div></span>
  </div>
  <%= f.actions do %>
    <%= f.submit %>
  <% end %>
<% end %>
<%
controller.js(
  map_layer_url: current_user.layer.url,
  map_lat: current_user.customer.store.lat,
  map_lng: current_user.customer.store.lng,
  map_attribution: t('all.osm_attribution_html', layer_attribution: current_user.layer.attribution),
  layers: Hash[Layer.all.collect{ |layer|
    [layer.id, {url: layer.url, attribution: layer.attribution}]
  }]
)
%>
