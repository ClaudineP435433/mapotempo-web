<h1><%= t('.title', resource: resource_class.model_name.human , default: 'Edit #{resource_name.to_s.humanize}') %></h1>

<%= twitter_bootstrap_form_for resource, as: resource_name, url: registration_path(resource_name), layout: :horizontal, default_div_class: 'col-lg-6' do |f| %>
  <%= devise_error_messages! %>
  <%= f.email_field :email %>
  <%= f.password_field :password, {autocomplete: 'off', add_on: 'append'} do %>
    <p class="help-block"><%= t('.leave_blank_if_you_don_t_want_to_change_it', default: "leave blank if you don't want to change it") %></p>
  <% end %>
  <%= f.password_field :password_confirmation %>
  <%= f.password_field :current_password, {add_on: 'append'} do %>
    <p class="help-block"><%= t('.we_need_your_current_password_to_confirm_your_changes', default: 'we need your current password to confirm your changes') %></p>
  <% end %>
  <%= f.collection_select :layer_id, [], Layer.all, :id, :name, {}, {} %>
  <div class="row">
    <span class="col-lg-offset-2 col-lg-6"><div id="map" style="width: 100%; height: 200px;"></div></span>
  </div>
  <%= f.actions do %>
    <%= f.submit t('.update', default: "Update") %>
  <% end %>
<% end %>

<h2><%= t('.cancel_my_account', default: 'Cancel my account') %></h2>

<p><%= t('.unhappy', default: 'Unhappy') %>? <%= link_to t('.cancel_my_account', default: "Cancel my account"), registration_path(resource_name), data: { confirm: t('.are_you_sure', default: "Are you sure?") }, method: :delete %>.</p>

<%
controller.js(
  map_layer_url: current_user.layer.url,
  map_lat: current_user.customer.store.lat,
  map_lng: current_user.customer.store.lng,
  map_attribution: t('all.osm_attribution_html', layer_attribution: current_user.layer.attribution),
  layers: Hash[Layer.all.collect{ |layer|
    [layer.id, {url: layer.url, attribution: layer.attribution}]
  }]
)
%>
